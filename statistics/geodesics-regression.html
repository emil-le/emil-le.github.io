<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Geodesics Regression | Statistical methods on Riemannian manifold with applications.</title>
  <meta name="description" content="Capstone Project." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Geodesics Regression | Statistical methods on Riemannian manifold with applications." />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Capstone Project." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Geodesics Regression | Statistical methods on Riemannian manifold with applications." />
  
  <meta name="twitter:description" content="Capstone Project." />
  

<meta name="author" content="Emil Le" />


<meta name="date" content="2021-03-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="statistics-on-riemannian-manifold.html"/>
<link rel="next" href="conclusion.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/rglWebGL-binding-0.104.16/rglWebGL.js"></script>
<link href="libs/rglwidgetClass-0.104.16/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-0.104.16/rglClass.min.js"></script>
<script src="libs/CanvasMatrix4-0.104.16/CanvasMatrix.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#motivation"><i class="fa fa-check"></i><b>1.1</b> Motivation</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#project-outline"><i class="fa fa-check"></i><b>1.2</b> Project outline</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#what-is-a-manifold"><i class="fa fa-check"></i><b>1.3</b> What is a Manifold?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="statistics-on-riemannian-manifold.html"><a href="statistics-on-riemannian-manifold.html"><i class="fa fa-check"></i><b>2</b> Statistics on Riemannian Manifold</a>
<ul>
<li class="chapter" data-level="2.1" data-path="statistics-on-riemannian-manifold.html"><a href="statistics-on-riemannian-manifold.html#riemannian-manifold"><i class="fa fa-check"></i><b>2.1</b> Riemannian Manifold</a></li>
<li class="chapter" data-level="2.2" data-path="statistics-on-riemannian-manifold.html"><a href="statistics-on-riemannian-manifold.html#instrinsic-moments"><i class="fa fa-check"></i><b>2.2</b> Instrinsic moments</a></li>
<li class="chapter" data-level="2.3" data-path="statistics-on-riemannian-manifold.html"><a href="statistics-on-riemannian-manifold.html#asymtomtic-behavior"><i class="fa fa-check"></i><b>2.3</b> Asymtomtic behavior</a></li>
<li class="chapter" data-level="2.4" data-path="statistics-on-riemannian-manifold.html"><a href="statistics-on-riemannian-manifold.html#normal-distribution"><i class="fa fa-check"></i><b>2.4</b> Normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="geodesics-regression.html"><a href="geodesics-regression.html"><i class="fa fa-check"></i><b>3</b> Geodesics Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="geodesics-regression.html"><a href="geodesics-regression.html#motivation-1"><i class="fa fa-check"></i><b>3.1</b> Motivation</a></li>
<li class="chapter" data-level="3.2" data-path="geodesics-regression.html"><a href="geodesics-regression.html#geodesics-regression-1"><i class="fa fa-check"></i><b>3.2</b> Geodesics Regression</a></li>
<li class="chapter" data-level="3.3" data-path="geodesics-regression.html"><a href="geodesics-regression.html#least-square-estimate"><i class="fa fa-check"></i><b>3.3</b> Least Square Estimate</a></li>
<li class="chapter" data-level="3.4" data-path="geodesics-regression.html"><a href="geodesics-regression.html#application"><i class="fa fa-check"></i><b>3.4</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i>Conclusion</a>
<ul>
<li class="chapter" data-level="3.5" data-path="conclusion.html"><a href="conclusion.html#references"><i class="fa fa-check"></i><b>3.5</b> References</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical methods on Riemannian manifold with applications.</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="geodesics-regression" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Geodesics Regression</h1>
<div id="motivation-1" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Motivation</h2>
<p>Before we get into geodesics regression, let’s recall a simple fitting model that reflects similar idea: <u>linear gression</u>. Let <span class="math inline">\(\mathbf{X} \in \mathbb{R}^{n\times m}\)</span> be a <span class="math inline">\(n\times m\)</span> matrix consists of our data points that we want to model against <span class="math inline">\(\mathbf{y}\in\mathbb{R}^{n}\)</span>. The question we ask here is how to find an <span class="math inline">\(m^{\text{th}}-\)</span>degree polynomial that is best-fit to our data (for example, if <span class="math inline">\(m=1\)</span> then it’s called line of best fit). The linear regression model is given as:
<span class="math display">\[
\begin{aligned}
\mathbf{y}_i &amp;= \mathbf{x}_{i1}^T\beta_1 + \mathbf{x}_{i2}^T\beta_2 + \dots + \mathbf{x}_{in}^T\beta_n + \alpha_i +\epsilon_i\\
&amp;= \mathbf{x}_i^T\beta + \alpha +\epsilon  \\ 
\implies \mathbf{Y} &amp;= \mathbf{X}{\beta} + {\alpha} + \epsilon
\end{aligned}
\]</span></p>
<p>We can quantify the notion of what is considered “best” for a fitting polynomial by choices of distance norm, for example, the method of least squares finds the the vertical distances of data points to the polynomial through the Eucledian norm. Here, the residual vector, <span class="math inline">\(\vec{e}\)</span>, represents error in calculation, so the optimalization problem is just for <span class="math inline">\(\beta\)</span>, that is the mean squared error estimator.
<span class="math display">\[\hat\alpha,\hat\beta= \arg\min_{\alpha,\beta} \sum_{i=1}^n\left(\mathbf{Y}- (\alpha+\mathbf{X}\beta) \right)^2\]</span>
<span class="math display">\[\hat\epsilon= \mathbf{Y}- (\hat\alpha+\mathbf{X}\hat\beta) \]</span></p>
<p>However, what about cases that the space of data lies on a Riemannian manifold such as a high dimensional sphere? Or if the projection of data from <span class="math inline">\(\mathbb{R}^n\)</span> on a manifold would better represent our data? By trying to find a polynomial lying on sub-dimensional space might be leading to over-fitting or resulted in a high variance result to determine. The key idea of geodesics regression is essential an analogy to linear regression, that is, finding the geodesics that fit data points lying on manifold domain the best. Here, the analogous version of a polynomial on <span class="math inline">\(\mathbb{R}^n\)</span> is an <u>exponential map</u>.</p>
</div>
<div id="geodesics-regression-1" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Geodesics Regression</h2>
<b> Definition </b> (Exponential Map). Let <span class="math inline">\(\vec{\mathbf{v}}\in T_p\mathcal{M}\)</span> be any vector in an arbitrary tangent plane of manifold <span class="math inline">\(\mathcal{M}\)</span>, then there exists a unique geodesic <span class="math inline">\(\gamma_v\)</span> satisfying <span class="math inline">\(\gamma_v(0) = p\)</span> and <span class="math inline">\(\gamma&#39;_v(0) = \vec{\mathbf{v}}\)</span>. The exponential map with respect to <span class="math inline">\(\vec{\mathbf{v}}\)</span> is given by:
<span class="math display">\[
\begin{aligned}
\exp_p: T_p\mathcal{M} &amp;\longrightarrow \mathcal{M}\\
\vec{\mathbf{v}} &amp;\longmapsto \gamma_v(1)
\end{aligned}
\]</span>
Note that the “exponential” part in its name is not explicitly reflected by the our usual reference to the exponent <span class="math inline">\(e^x\)</span>, we can simply think of it as a map that sends a vector from the tangent space of a point on the manifold to a geodesics on the manifold. The logarithm map <span class="math inline">\(\log_p: \mathcal{M}\to T_p\mathcal{M}\)</span> is the inverse of the exponent map that sends a geodesics on a manifold to the tangent space.
<center>
<p><img src="dataset/exponent.png" width="350" /></p>
Figure 2.1: Tangent space at a point <span class="math inline">\(p\in\mathcal{M}\)</span> with an exponential map visualized.
</center>
<p>Let’s re-define the notation <span class="math inline">\(\exp_p (\vec{\mathbf{v}}) = \exp(p,\vec{\mathbf{v}})\)</span>, then the regression module for <span class="math inline">\(\mathbf{X} \subset \mathbb{R}^n\)</span> is given by:
<span class="math display">\[
\begin{aligned}
\mathbf{y} = \exp(\exp(\alpha,\mathbf{X}\beta),\epsilon)
\end{aligned}
\]</span>
To think about this model, let’s us point out that an exponential map <span class="math inline">\(\exp(\alpha,\mathbf{X\beta})\)</span> is simply the addition of vectors: <span class="math inline">\(\alpha+\mathbf{X}\beta\)</span>. Then <span class="math inline">\(\exp(\exp(\alpha,\mathbf{X}\beta),\epsilon) = \alpha+\mathbf{X}\beta+\epsilon\)</span>, thus it’s the linear regression “version” on the Riemannian manifold!</p>
<center>
<p><img src="dataset/geodereg1.png" width="400" /></p>
Figure 2.2: Geodesics regression on sample data lying on <span class="math inline">\(S^2\)</span>.
</center>
</div>
<div id="least-square-estimate" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Least Square Estimate</h2>
<p>Let <span class="math inline">\((\mathbf{x_1}, \mathbf{y_1}), (\mathbf{x_2}, \mathbf{y_2}),\dots,(\mathbf{x_n}, \mathbf{y_n})\)</span> be a set of points on a Riemannian manifold <span class="math inline">\(\mathcal{M}\)</span> satisfying the geodesics model, <span class="math inline">\(\mathbb{E}[\mathbf{y} \vert \mathbf{x}]= \exp(\exp(\alpha,\mathbf{x}\beta),\epsilon)\)</span>, the least square estimate for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> is given by the optimalization problem:
<span class="math display">\[\hat\alpha,\hat\beta = \arg\min_{\alpha,\beta} \sum_{i=1}^n\left(\mathbf{Y}- \exp(\alpha,\mathbf{X}\beta)\right)^2\]</span>
Unlike linear regression, we cannot find a closed form solution for this problem, but we can approximate the solution with <a href="https://en.wikipedia.org/wiki/Gradient_descent">gradient descent</a>.</p>
<p>The predicted value for <span class="math inline">\(\mathbf{y}\)</span> and the residue are, respectively, given by:
<span class="math display">\[
\begin{aligned}
\mathbf{\hat y}_i &amp;= \exp(\hat\alpha,\mathbf{x}_i\hat\beta)\\
\hat\epsilon_i &amp;= \log(\mathbf{\hat y}_i,\mathbf{y}_i) \\
\end{aligned}
\]</span></p>
<center>
<p><img src="dataset/download.png" width="400" /></p>
Figure 2.3: Geodesics regression on sample data lying on <span class="math inline">\(S^2\)</span>.
</center>
<p>Though, one of the important task to do after finding a geodesics fit model is to determine whehther this relationship is statistically significant. Firstly, the Frechet variance <span class="math inline">\(\sigma^2\)</span> of <span class="math inline">\(\{\mathbf{y}_i\}_{i=1,2,\dots,n}\)</span> and of the residue terms are given by:</p>
<span class="math display">\[
\begin{aligned}
\sigma^2 &amp;= \frac{1}{n}\min_{z\in\mathcal{M}}\sum_{i=1}^n\rho^2(z,\mathbf{y}_i)\\
\text{Var}[\hat\epsilon] &amp;= \frac{1}{n}\min_{z\in\mathcal{M}}\sum_{i=1}^n\rho^2(z,\hat\epsilon_i)
\end{aligned}
\]</span>
The coefficient of determination, <span class="math inline">\(R^2\)</span>, which denotes the proportion of global variance across <span class="math inline">\(\mathbf{y}_i\)</span> that can attributed by the geodesics regression with <span class="math inline">\(\mathbf{x}\)</span> is given bt:
<span class="math display">\[R^2 = 1-\frac{\sigma^2}{\text{Var}[\hat\epsilon]}\]</span>
<center>
<p><img src="dataset/geodereg2.png" width="350" /></p>
Figure 2.4: The residue plotted against increasing iterations of gradient descent.
</center>
<p><u>Example</u> The <span class="math inline">\(R^2\)</span> statistics of the geodesics regression on 100 sample points on <span class="math inline">\(S^2\)</span> (figure 2.3) is 0.97. Then 97% of the variation in <span class="math inline">\(\mathbf{y}\)</span> is explained by the geodesics regression with 3% is attributed by other factors. From figure 2.4, we can see that the the residue factors are relatively low as we induced more iterations in gradient descent. Thus, this geodesics regression is a good fit for our data set.</p>
</div>
<div id="application" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Application</h2>
<p>In the original paper, Fletcher shows an application in medical image by projecting the shape of corpus callosum onto Kendall’s Shape Space. This is the complex projective space <span class="math inline">\(\mathbb{C}P^{k-2}\)</span> (analogous to the real projective space <span class="math inline">\(\mathbb{R}P^{k-1}\)</span>), which is a topological space constructed from removing the translation from the original space of data, and forming the quotient space from equivalence classes by identifying points that can be formed by scalings and rotations. Here, the shapes of the input lying on a high dimensional Riemannian manifold, which allows us to compute the geodesics regression and the mean shape!</p>
<center>
<p><img src="dataset/shape4.png" width="350" /></p>
Figure 2.5: The sample shape of “heart-”shape Bezier Splines.
</center>
<center>
<p><img src="dataset/meanshape.png" width="350" /></p>
Figure 2.6: The mean shape of “heart-”shape Bezier Splines sample.
</center>


</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="statistics-on-riemannian-manifold.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conclusion.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-geodesicsreg.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
