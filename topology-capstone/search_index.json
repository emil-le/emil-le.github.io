[["preface.html", "Discrete Morse Theory and application in Topological data analysis. Preface", " Discrete Morse Theory and application in Topological data analysis. Emil Le 2021-03-26 Preface Medical data analysis has been growing as an important field that assist and process non-linear data. Applications can be of results from sub-field of computer vision, which includes difficult tasks such as segmentation and finding visual correspondence. However, there are many important practical invariant about medical data that are hard to incorporate in methodologies in a meaningful manners. Computational algebraic topology including persistence homology, one of the tool used in topological data analysis, rises as an approach to study the shape of high-dimensional data and provide dimensionality-reduction method that is robust to noises. In this capstone project, we investigate on the algebraic version of Morse theory (discrete Morse theory) with its applications in find and reconstruct the skeletonization of neuron data. \\[\\text{Figure: Sublevel set persistence of a 3D plot.}\\] "],["intro.html", "Chapter 1 Introduction 1.1 Motivation 1.2 Morse Theory 1.3 Algebraic topology", " Chapter 1 Introduction 1.1 Motivation Understanding and reconstructing the network architecture of the brain is one of the fundamental task in neuroscience. Typically, neuroanatomical data are usually represented as tree-shape due to its biochemical reaction activity. As both global and local behavior are important characteristics of any network, finding a method to extract the skeletonization of the neurons that preserved the topological structure of neuronal data is necessary. This is more or less the fundamental idea and advantage of topological data analysis methods, which we will explore how Morse theory comes into play. Essentially, the idea of Morse theory (and discrete Morse theory), a field in differential topology, is that a reasonable choice of a function can reflect a lot of information about a topological space. \\[\\text{Figure 1.1: Several critical points of a distribution.}\\] 1.2 Morse Theory The fundamental idea of Morse theory is that a sensible differential function can inform a lot about a manifold, so what is consider a sensible function? Example Consider a unit sphere \\(S^2\\subset \\mathbb{R}^3\\) with the function \\(f\\) that collapse the sphere into the \\(z-\\)axis: \\[ \\begin{aligned} S^2 = \\{(x,y,z)&amp;\\vert x^2 + y^2 + z^2 = 1\\} \\\\ \\\\ f\\text{ }: S^2 &amp;\\longrightarrow \\mathbb{R} \\\\ (x,y,z)&amp;\\longmapsto z \\end{aligned} \\] The gradient of \\(f\\) is \\(\\nabla f = [0 \\text{ } 0 \\text{ }1]^\\text{T}\\). Let \\(m\\in\\mathbb{R}\\), we can see that the critical point of \\(f\\) encodes information about the sub-level set of \\(S^2\\): Let \\(m\\subset \\mathcal{R}\\), consider the pre-image of M under \\(f\\): \\[ f^{-1}(m) = \\begin{cases} \\emptyset &amp;\\text{ if } m &lt; -1\\\\ (0,0,1)&amp;\\text{ if } m = -1\\\\ \\text{a circle } &amp;\\text{ if } -1&lt; m &lt; -1\\\\ (0,0,-1) &amp; \\text{ if } m &lt; = 1\\\\ \\emptyset &amp;\\text{ if } m &gt; 1 \\end{cases} \\] \\[\\text{Figure 1.2: Critical points of a 2-sphere.}\\] \\[ f^{-1}((-\\infty,m]) = \\begin{cases} \\emptyset &amp;\\text{ if } m &lt; -1\\\\ \\text{a point }&amp;\\text{ if } m = -1\\\\ \\text{a half-sphere } &amp;\\text{ if } -1&lt; m &lt; -1\\\\ S^2 &amp; \\text{ if } m \\geq 1\\\\ \\end{cases} \\] \\[\\text{Figure 1.3: Sublevel pre-image on the 2-sphere domain.}\\] Here, we can see that the critical points of \\(S^2\\) and its sub-level set from the height function can tell us about the number of \\(n-\\)dimensional holes of \\(S^2\\). Intuitively, these are the specific topological signature of some shapes in spaces. Before we get into the definition of a Morse function, let’s recall some key definition: Definition (Manifold) An \\(n-\\)manifold \\(\\mathcal{M}\\subset\\mathbb{R}^n\\) is a \\(T_2\\) topological space (Hausdorff and with countable basis), where there exists a neighborhood \\(U\\subseteq \\mathcal{M}\\) for every \\(m\\in\\mathcal{M}\\) such that \\(U\\) is homeomorphic to an open ball in \\(\\mathbb{R}^n\\) induced by the Eucledian metric. \\[\\text{Figure 1.4: The torus is a manifold but the mobius strip is not.}\\] Definition (Critical Point) For an \\(n-\\)manifold \\(\\mathcal{M}\\subset\\mathbb{R}^n\\), let \\(f: \\mathcal{M} \\to \\mathbb{R}\\). An critical point of \\(f\\) is \\(x\\in\\mathcal{M}\\) such that \\(\\frac{\\partial f}{\\partial x} = 0\\) \\[ \\begin{aligned}\\text{Figure 1.5:} &amp;\\text{ (Top row) Minimum critical point and maximum critical point.}\\\\ &amp;\\text{ (Bottom row) Saddle critical point.} \\end{aligned} \\] Intuitively, a Morse function is a function maps a manifold domain to \\(\\mathbb{R}\\) with all critical points are non-degenerative (local maximum, minimum, or saddle point). However, a function on a manifold domain does not have second-derivative, but we can define it on local point. Definition (Nondegenerative) Let \\(x \\in \\mathcal{M}\\) be a critical point of \\(f: \\mathcal{M} \\to \\mathbb{R}\\). Consider the tangent space at \\(x\\), \\(T_x\\mathcal{M}\\), let \\(\\vec{\\mathbf{u}},\\vec{\\mathbf{v}} \\in T_x\\mathcal{M}\\) be arbitrary. Define \\(\\partial^{2} f_x(\\vec{\\mathbf{u}},\\vec{\\mathbf{v}}) = \\vec{\\mathbf{u}}(\\bar{\\vec{\\mathbf{v}}}f)(x)\\) (where \\(\\bar{\\vec{\\mathbf{v}}}\\) is an local extension of \\(\\vec{v}\\)), then the Hessians for \\(f\\) is given by: \\[ \\begin{align} \\mathbf{H}_{f_{ij}} &amp;\\equiv \\frac{\\partial^{2} f}{\\partial x_{i} \\partial x_{j} } \\\\ \\mathbf{H}_{f} &amp;= \\begin{bmatrix} \\frac{\\partial^{2} f}{\\partial x_{1}^2} &amp; \\frac{\\partial^{2} f}{\\partial x_{1} \\partial x_{2} } &amp; \\dots &amp; \\frac{\\partial^{2} f}{\\partial x_{1} \\partial x_{n} } \\\\ \\frac{\\partial^{2} f}{\\partial x_{2} \\partial x_{1} } &amp; \\frac{\\partial^{2} f}{\\partial x_{2}^2 } &amp; \\dots &amp; \\frac{\\partial^{2} f}{\\partial x_{2} \\partial x_{n} } \\\\ \\vdots &amp; \\vdots &amp;\\ddots &amp; \\vdots \\\\ \\frac{\\partial^{2} f}{\\partial x_{n}\\partial x_{1}} &amp; \\frac{\\partial^{2} f}{\\partial x_{n} \\partial x_{2} } &amp; \\dots &amp; \\frac{\\partial^{2} f}{\\partial x_{n}^2 } \\end{bmatrix} \\end{align} \\] The critical point \\(x\\) is non-degenerative if its Hessian matrix is invertible. Definition (Morse Function) A Morse function is a function that the Hessian value of every critical point is non-degenerative. There are several interesting results from Morse theory that are out of scope for the project. However, informally speaking, one of the relevant finding is that most functions are Morse function. Recall in calculus III, we can approximate a function by its Taylor expansion to the second derivative at a point \\(a\\) in the domain: \\[f(x) \\approx f(a) + \\frac{1}{1!}f&#39;(a)(x-a) + \\frac{1}{2!}f&#39;&#39;(a)(x-a)^2\\] Then the Morse lemma states that for a Morse function \\(f\\) with critical point \\(a\\), then there exists a local chart \\((x_1,x_2,\\dots,x_n)\\) such that: \\[f(x) = f(x_1,x_2,\\dots,x_n) = f(a) - \\sum_{i=1}^jx_i^2 + \\sum_{i=j+1}^nx_i^2 \\] Furthermore, for a compact manifold \\(\\mathcal{M}\\), its critical values are only dependent on \\(\\mathcal{M}\\) regardless of choices for the Morse function. There are many fascinating applications of Morse theory in dynamics system, density estimation, etc, however, this project focuses on the discrete version of Morse theory. Namely, we apply the similar idea from persistence homology to find the persistence critical points from the triangulation of our inputs. 1.3 Algebraic topology In simplest term, topologists differentiate abstract spaces by finding its homeomorphic invariants such as compactness, Hausdorff property, connectivity, etc. Algebraic topology turns abstract topological space into combinatorical object to study and compute topological invariant in “holes” of a space using linear algbera. Definition A \\(k-\\)simplex \\(\\Delta = [v_0,v_1\\dots,v_n]\\) is the smallest convex subspace of \\(\\mathbb{R}^n\\) containing \\(k+1\\) points which are affinitely independent. \\[\\text{Figure 1.6: From left to right respectively, a 0-simpliex (a point), 1-simplex (an edge), 2-simplex (a filled triangle) and 3-simplex (a filled tetrahedron).}\\] Morse theory study a another type of invariant of differentiable manifold by looking at its differential function, specifically its critical values, defined on that space. Discrete Morse theory uses the same idea by turning these gradient field into “simpler” complexes that can represent the topological space. "],["discrete-morse-theory.html", "Chapter 2 Discrete Morse Theory 2.1 Discrete gradient field 2.2 Morse Homology 2.3 Subset level filtration", " Chapter 2 Discrete Morse Theory 2.1 Discrete gradient field Definition Codimension-1 faces For a simplicial complex \\(\\mathcal{X}\\) consists of simplicies \\(\\Delta^n_\\alpha,\\Delta^{n+1}_\\beta\\in \\mathcal{X}\\), if \\(\\Delta^n_\\alpha,\\subset\\Delta^{n+1}_\\beta\\) then we say: \\(\\Delta^n_\\alpha\\) is a face (codimension-1 face) of \\(\\Delta^{n+1}_\\beta\\), denoted as \\(\\Delta^n_\\alpha\\in\\partial\\Delta^{n+1}_\\beta\\). \\(\\Delta^{n+1}_\\beta\\) is a co-face of \\(\\Delta^n_\\alpha\\). Figure 2.1: Funky tikz Definition Discrete Morse function For a simplicial complex \\(\\mathcal{X}\\), a discrete Morse function \\(f:\\mathcal{X}\\to\\mathbb{R}\\) is one satisfying the two conidtions: \\(\\text{Card}\\left\\{\\Delta^n_\\alpha \\big\\vert f(\\Delta^n_\\alpha)\\leq f(\\Delta^{n+1}_\\beta), \\Delta^n_\\alpha\\in\\partial\\Delta^{n+1}_\\beta\\right\\} \\leq 1\\) for all \\(\\Delta\\in\\mathcal{X}\\). \\(\\text{Card}\\left\\{\\Delta^{n+2}_\\gamma \\big\\vert f(\\Delta^{n+2}_\\gamma)\\leq f(\\Delta^{n+1}_\\beta), \\Delta^{n+1}_\\beta\\in\\partial\\Delta^{n+2}_\\gamma\\right\\} \\leq 1\\) for all \\(\\Delta\\in\\mathcal{X}\\). Example For a simplicial complex \\(\\mathcal{K}\\) Figure 2.2: Funky tikz Definition: Critical simplex For a simplicial complex \\(\\mathcal{X}\\) with a discrete Morse function \\(f:\\mathcal{X}\\to\\mathbb{R}\\), a simplex \\(\\Delta^{n+1}_\\beta\\in\\mathcal{X}\\) is a critical simplex if: \\(\\text{Card}\\left\\{\\Delta^n_\\alpha \\big\\vert f(\\Delta^n_\\alpha)\\leq f(\\Delta^{n+1}_\\beta), \\Delta^n_\\alpha\\in\\partial\\Delta^{n+1}_\\beta\\right\\} = 0\\) for all \\(\\Delta\\in\\mathcal{X}\\). \\(\\text{Card}\\left\\{\\Delta^{n+2}_\\gamma \\big\\vert f(\\Delta^{n+2}_\\gamma)\\leq f(\\Delta^{n+1}_\\beta), \\Delta^{n+1}_\\beta\\in\\partial\\Delta^{n+2}_\\gamma\\right\\} =0\\) for all \\(\\Delta\\in\\mathcal{X}\\). Figure 2.3: Funky tikz If \\(\\Delta\\) is a critical simplex, then \\(f(\\Delta)\\) is a critical value. In the case of 3D images, the critical cells of dimensions 0, 1, 2 and 3 correspond to minima, 1-saddles, 2-saddles and maxima, respectively, in the scalar field. Definition Discrete vector field A discrete vector field (or a Morse pairing) \\(\\mathcal{V}\\) for a simplicial complex \\(\\mathcal{K}\\) is a collection of pairs of simplices \\((\\Delta^n_\\alpha,\\Delta^{n+1}_\\beta)\\) (\\(\\forall\\Delta\\in\\mathcal{K}\\)) such that each simplex appear in at most a pair. In graph representation \\(G=(V,E)\\) of \\(\\mathcal{V}\\), the vertex set \\(V\\) denote the simplicies of \\(\\mathcal{K}\\) and the edge set is defined as \\(E = \\{e\\in \\mathcal{V}\\}\\). Definition Hasse diagram Let \\(G = (V,E)\\) be a directed graph with \\(V\\) are the set consisting of simplicies in a simplicial complex \\(\\mathcal{K}\\) with discrete vector field \\(\\mathcal{V}\\). An directed edge \\((\\tau,\\sigma)\\in E\\) in the edge set \\(E\\) if \\(\\sigma\\in\\partial\\tau\\). A (modified) Hasse diagram \\(H=(V,E&#39;)\\) is a directed graph with the same vertex set \\(V\\) of \\(G\\), and an edge \\((\\tau,\\sigma)\\in E&#39;\\) if \\(e\\in E\\) with the exception that the direction of \\((\\tau,\\sigma)\\) would be changed to an opposite direction \\((\\sigma,tau)\\)if there is a vector from \\(tau\\) to \\(\\sigma\\) in \\(\\mathcal{V}\\). Example Figure 2.4: Funky tikz Definition Gradient vector field A discrete Morse function defines a discrete vector field (gradient Morse pairing) by pairing (\\((\\Delta^n_\\alpha,\\Delta^{n+1}_\\beta)\\)) whenever \\(f(\\Delta^n_\\alpha)&lt;f(\\Delta^{n+1}_\\beta)\\). The critical cells are precisely those that do not appear in any pair. Discrete vector fields that arise from Morse functions are called gradient vector fields. Definition V-Path A V-path of gradient vector field \\(\\mathcal{V}\\) is a sequence of simplicies \\(\\Delta\\in\\mathcal{V}\\) such that: \\[P=\\{\\sigma^{n}_{0},\\tau^{n+1}_{0},\\sigma^{n}_{1},\\tau^{n+1}_{1},\\sigma^{n}_{2},\\tau^{n}_{2},\\dots,\\sigma^{n}_{r-1},\\tau^{n+1}_{r-1},\\sigma^{n}_{r}\\}\\] where \\(\\sigma^n_i\\in\\partial\\tau^{n+1}_i\\) for \\(i=0,1,\\dots,r-1\\). A V-path is trivial if \\(r = 0\\). and is closed if \\(r&gt;0\\) and \\(\\sigma^n_r=\\sigma^n_0\\). Figure 2.5: Funky tikz Theorem A discrete vector field is the gradient vector field of a discrete Morse function if and only if there are no non-trivial closed V-paths and every V-path is unique. Proof (\\(\\implies\\)) Assume a discrete vector field \\(\\mathcal{V}\\) is a gradient vector field inducded by discrete Morse function \\(f\\) on a simplicial complex \\(\\mathcal{K}\\). By way of contradiction, assume there is a closed V-path \\(P=\\{\\sigma^{n}_{0},\\tau^{n+1}_{0},\\sigma^{n}_{1},\\tau^{n+1}_{1},\\sigma^{n}_{2},\\tau^{n}_{2},\\dots,\\sigma^{n}_{r-1},\\tau^{n+1}_{r-1},\\sigma^{n}_{r},\\sigma^{n}_{0}\\}\\) in \\(\\mathcal{V}\\). Since every simplex in \\(\\mathcal{K}\\) appears in at most one pair in \\(\\mathcal{V}\\) and by definition of the discrete Morse function, we have: \\[f(\\sigma^{n}_{0})&lt; f(\\tau^{n+1}_{r-1}) &lt;\\dots &lt; f(\\sigma^{n}_{r})&lt;f(\\sigma^{n}_{0})\\] This is a contradiction, so there would be no closed V-path in \\(\\mathcal{V}\\). Similarly, if there were any trivial path in \\(\\mathcal{V}\\), then \\(f(\\sigma^{n}_{0})&lt;f(\\sigma^{n}_{0})\\) is also a contradiction. ( \\(\\Longleftarrow\\) ) Assume there exists a discrete vector field \\(\\mathcal{V}\\) contains no trivial or closed V-path, then there exists a discrete Morse function on \\(\\mathcal{V}\\). Lemma 1 If discrete gradient \\(\\mathcal{V}\\) has a closed \\(V-\\)path if the corresponding Hasse diagram \\(H\\) is acyclic. By using contraposition, we show that if the corresponding Hasse diagram \\(H\\) of discrete gradient \\(\\mathcal{V}\\) is cyclic then there exists a closed \\(V-\\)path. Supposed that \\(H\\) has a cycle \\(C\\), then \\(C\\) can only contains simplicies of \\(k\\) and \\((k+1)-\\)dimension for some \\(k \\leq \\dim\\mathcal{K}-1\\). By way of contradiction, assume the cycle \\(C\\) contains some simplicies of dimension \\(d\\) such that \\(d\\neq k,k+1\\). Without loss of generality, assume \\(d&lt;k\\). Since at every sub-path in \\(C\\), we must move up or down in 1 dimension, if there exists \\(\\Delta^d\\) in the cycle, then we would have moved up \\(k-d+1\\) times from \\(\\Delta_i^d\\) to \\(\\Delta_j^k\\). This implies there are \\(k-d\\) simplicies appearing in \\(\\mathcal{V}\\): (\\(\\Delta_i^d,\\alpha^{d+1}\\)), (\\(\\alpha^{d+1},\\alpha^{d+2}\\)), \\(\\dots\\), (\\(\\alpha^{k-1},\\Delta_j^{k}\\)). This is a contradiction since every simplicies must appear in at most 1 pair, so cycle \\(C\\) must only contain contains simplicies of \\(k\\) and \\((k+1)-\\)dimension for some \\(k\\). Again, since the cycle \\(C\\) of some simplicies of \\(k\\) and \\((k+1)-\\)dimension, assume of length \\(2n+1\\), each upward arrows represents \\((\\Delta^k_i,\\Delta^{k+1}_i)\\in\\mathcal{V}\\) for \\(i=0,1,\\dots,n-1\\) satisfying \\(\\Delta^k_i\\in\\partial\\Delta^{k+1}_i\\) and \\(a_i\\neq a_{i+1}\\). Since \\(C\\) is cyclic, then there is an arrow from \\(\\Delta^k_n\\) to \\(\\Delta^k_0\\) (\\((\\Delta^k_0,\\Delta^k_n)\\in\\mathcal{V}\\)), which gives us a closed path \\((\\Delta^k_0,\\Delta^{k+1}_0,\\Delta^k_1,\\Delta^{k+1}_1,\\dots,\\Delta^k_{n-1},\\Delta^{k+1}_{n-1},\\Delta^k_n=\\Delta^k_0)\\) in \\(\\mathcal{V}\\). QED. Lemma 2 Let \\(H = (V,E)\\) be a finite directed graph. Then \\(H\\) is acylic iff there exists \\(f: V\\to\\mathbb{R}\\) satisfying \\(f(v_i)&gt;f(v_j)\\) (\\(i\\neq j\\)) for arbitrary \\(v_i,v_j\\in V\\) and \\((v_i,v_j)\\in H\\). (\\(\\implies\\)) Assume there exists such \\(f\\), by way of contradiction, assume there exists a cycle in \\(H\\): \\((v_0,v_1,\\dots v_n,v_0)\\). Then we have \\(f(v_0)&gt;f(v_1)&gt;\\dots&gt;f(v_n)&gt;f(v_0)\\), which is a contradictoin. Thus, \\(H\\) is acyclic. (\\(\\Longleftarrow\\)) Assume \\(H\\) is acyclic, let \\(V&#39;\\subseteq V\\) be defined as \\(V&#39; = \\{v\\in V \\vert \\exists v&#39;\\in V \\text{ s.t. } (v,v&#39;)\\in E\\}\\) with \\(I\\) be the fixed index set of \\(v\\in V&#39;\\). Let \\(d = \\dim V&#39;\\), define function \\(f: V\\to \\mathbb{R}\\) that maps \\(v_i \\mapsto d - i\\) for \\(i=0,1,2,\\dots,d-1\\). Since the index set is fixed, if \\(i&gt;j\\) and \\((v_i,v_j)\\in E\\) then \\(f(v_i)&gt;f(v_j)\\) so \\(f\\) is the satisfied function. By Lemma 1, since \\(\\mathcal{V}\\) contains no closed path, then the corresponding Hasse diagram \\(H= (V,E)\\) is acyclic. By Lemma 2, there exists \\(f: V\\to\\mathbb{R}\\) satisfying \\(f(v_i)&gt;f(v_j)\\) (\\(i\\neq j\\)) for arbitrary \\(v_i,v_j\\in V\\) and \\((v_i,v_j)\\in H\\). Every vertex of \\(H\\) is an \\(k-\\)simplex of \\(\\mathcal{K}\\). If we defined the fixed index set of \\(H\\) based on the dimension of the simplex, then \\(f\\) maps a higher-dimensional simplices to a higher value. Furthermore, since \\(H\\) is acyclic, then every simplex appears in at most 1 pair of simplicies in \\(\\mathcal{V}\\). Thus, \\(f\\) is the satisfied discrete Morse function on \\(\\mathcal{V}\\) so \\(\\mathcal{V}\\) is a gradient vector field. Theorem Morse cancellation / simplification. Let f be a discrete Morse function on \\(\\mathcal{K}\\) such that \\(\\Delta^n_0,\\Delta^{n+1}_0\\) are critical simplices. Suppose there exists a non-trivial V-path of gradient vector field \\(\\mathcal{V}\\) induced by \\(f\\) \\[P=\\{\\sigma = \\sigma^{n}_{0},\\tau^{n+1}_{0},\\sigma^{n}_{1},\\tau^{n+1}_{1},\\sigma^{n}_{2},\\tau^{n}_{2},\\dots,\\sigma^{n}_{r-1},\\tau^{n+1}_{r-1},\\sigma^{n}_{r},\\tau^n_r=\\tau\\}\\] satisfying \\(\\sigma^n_i\\in\\partial\\tau^{n+1}_i\\) with pairing \\(\\{\\tau^{n+1}_{i},\\sigma^n_{i+1}\\}\\) for \\(i=0,1,\\dots,r\\). Then there exists another discrete Morse function \\(f&#39;\\) on \\(\\mathcal{K}\\) such that it has the same critical simplicies as \\(f\\) but \\(\\sigma,\\tau\\) are no longer critical. Proof Define \\(\\mathcal{V}&#39;\\) as a collection of pairs of all simplices \\((\\Delta^n_\\alpha,\\Delta^{n+1}_\\beta)\\) (\\(\\forall\\Delta\\in\\mathcal{K}\\)) satisfying: \\(\\mathcal{V}&#39; - P = \\mathcal{V} - P\\) \\((\\sigma_i,\\tau_i)\\in \\mathcal{V}&#39;\\) for \\(i=0,1,2,\\dots,r\\) Essentially, we keep the initial pairing of simplicies in \\(\\mathcal{V}\\) that does not belong to the path \\(P\\), and assign those to \\(\\mathcal{V}&#39;\\). And for simplicies in \\(P\\) with the original pairing \\(\\{\\tau^{n+1}_{i},\\sigma^n_{i+1}\\}\\), we change to \\((\\sigma_i,\\tau_i)\\) to put those in \\(\\mathcal{V}&#39;\\). By definition, \\(\\mathcal{V}&#39;\\) is a discrete vector field because there are no simplicies appearing in more than a pair by the way we construct it. To show that \\(\\mathcal{V}&#39;\\) is a gradient vector field (by previous theorem , essentially pointing out there exists a discrete Morse function \\(f&#39;\\) satisfying the property), it’s sufficient to show that the exists no non-trivial closed V-paths and every V-path is unique. From (1), since \\(\\mathcal{V}&#39;\\) differs from \\(\\mathcal{V}\\) by \\(P\\) and there are no non-trivial or closed paths in \\(\\mathcal{V}\\) by definition, so there would not be any non-trivial paths in \\(\\mathcal{V}&#39;\\). The V-path \\(P\\) is also non-trivial by definition, so if there were any trivial or closed paths in \\(\\mathcal{V}&#39;\\), it would have been in some sub-path of \\(P\\). By way of contradiction, let’s suppose a closed sub-path \\(P_0\\) of \\(P\\) defined by \\(\\sigma^n_k,\\delta_i,\\dots,\\delta_j,\\sigma^n_k\\) for some \\(\\delta_i,\\dots,\\delta_j\\in\\mathcal{K}\\). Then \\(P&#39;= \\{\\sigma = \\sigma^{n}_{0},\\dots,\\sigma^n_k,\\delta_i,\\dots,\\delta_j,\\sigma^n_k,\\dots\\sigma^{n}_{r-1},\\tau^{n+1}_{r-1},\\sigma^{n}_{r},\\tau^n_r=\\tau\\}\\) is another \\(V-\\)path from \\(\\sigma\\) to \\(\\tau\\). This is a contradiction since any \\(V-\\)path from \\(\\sigma\\) to \\(\\tau\\) must be unique. Thus, \\(\\mathcal{V}&#39;\\) must not contain any closed V-path. We can show that every V-path in \\(\\mathcal{V}&#39;\\) is unique by a similar method. Again, since \\(\\mathcal{V}&#39;\\) differs from \\(\\mathcal{V}\\) by \\(P\\) so any V-path in \\(\\mathcal{V}&#39;- P\\) is unique. Thus, it is sufficient to show that \\(P&#39;=\\{\\tau^{n+1}_{0},\\sigma^{n}_{1},\\tau^{n+1}_{1},\\sigma^{n}_{2},\\tau^{n}_{2},\\dots,\\sigma^{n}_{r-1},\\tau^{n+1}_{r-1},\\sigma^{n}_{r},\\tau^n_r=\\tau,\\sigma = \\sigma^{n}_{0}\\}\\) is unique. By way of contradiction, assume there exists another \\(V-\\)path from \\(\\tau^{n+1}_{0}\\) to \\(\\sigma\\): \\(P_0=\\{\\sigma = \\sigma^{n}_{0},\\dots,\\sigma^n_k,\\delta_i,\\dots,\\delta_j,\\sigma^n_k,\\dots\\sigma^{n}_{r-1},\\tau^{n+1}_{r-1},\\sigma^{n}_{r},\\tau^n_r=\\tau\\}\\). Then \\(P&#39;\\cup P_0\\) is a closed V-path, which contradicts the fact that \\(\\mathcal{V}&#39;\\) must not contain any closed V-path. Therefore, \\(\\mathcal{V}&#39;\\) is a gradient vector field of some discrete Morse function \\(f&#39;\\) satisfying that it has the same number of critical simplicies but \\(\\tau\\) and \\(\\sigma\\) are no longer critical. 2.2 Morse Homology The connection between discrete Morse theory and simple homotopy arises from the pairs in the gradient vector field. The number of critical points modulo 2 of a Morse function depends only on the manifold and not on the function. Definition Chain Complex and Boundary Operator Let \\(\\mathcal{K}\\) be a simplicial complex, and \\(C_n(K)\\) denotes the \\(\\mathbb{Z}_2\\)-vector space with basis are the set of \\(k-\\)simplices contained in \\(\\mathcal{K}\\). The boundary operator is the linear transformation: \\[ \\begin{aligned} \\partial_n: C_n(K) &amp;\\longrightarrow C_{n+1}(K)\\\\ [v_0v_1\\dots v_n] &amp;\\longmapsto [v_0\\dots v_{j-1}v_{j+1}v_n] \\end{aligned} \\] And the chain complex is the sequence of linear transformation: \\[C_{\\ast}: \\dots \\overset{\\partial_{n+1}}{\\longrightarrow}C_{n}(K)\\overset{\\partial_{n}}{\\longrightarrow}C_{n-1}(K)\\overset{\\partial_{n-1}}{\\longrightarrow}\\dots\\overset{\\partial_{4}}{\\longrightarrow}C_{3}(K)\\overset{\\partial_{3}}{\\longrightarrow}C_{2}(K)\\overset{\\partial_{2}}{\\longrightarrow}C_{1}(K)\\overset{\\partial_{1}}{\\longrightarrow}C_{0}(K)\\] where \\(\\partial_{k-1}\\circ\\partial_k = 0\\) for all \\(i\\geq 2\\) \\[ \\begin{aligned} \\text{Define: }Z_i &amp;= \\bigoplus_{\\alpha\\in\\mathbb{Z}_2}(Z_i)_\\alpha = \\text{Ker}(\\partial_i) \\text{ denotes the number of i-dimensional cycle}\\\\ B_i &amp;= \\bigoplus_{\\alpha\\in\\mathbb{Z}_2}(Z_i)_\\alpha = \\text{Im}(\\partial_{i+1}) \\text{ denotes the boundary of } C_i\\\\ \\text{Then: } H_i &amp;= \\frac{Z_i}{B_i} \\text{ denotes the i-th homology group} \\end{aligned} \\] Definition For a simplicial complex \\(\\mathcal{K}\\) with discrete Morse function \\(f:\\mathcal{K}\\to\\mathbb{R}\\). For arbitrary simplicies \\(\\Delta^{n+1}_\\beta,\\Delta^{n}_\\alpha\\in\\mathcal{K}\\), define \\(\\Gamma(\\Delta_\\beta,\\Delta\\alpha)\\) as the number of \\(V-\\)path from maximals faces of \\(\\Delta_\\beta\\) to \\(\\Delta_\\alpha\\). Definition Let \\(C_p(\\mathcal{K},\\mathbb{Z}_2)\\) denote the \\(\\mathbb{Z}_2\\)-coefficient chain of simplicial complex \\(\\mathcal{K}\\). Let \\(M_p\\subseteq C_p(\\mathcal{K},\\mathbb{Z}_2)\\) be the sub-complexes consisting of critical \\(p-\\)simplex \\(\\Delta^p\\), define \\(\\overset{\\sim}{\\partial_p}: \\mathcal{M}_p\\to\\mathcal{M}_{p-1}\\): \\[\\partial_p(\\Delta_{\\beta}) = \\sum_{\\Delta_\\alpha\\in\\mathcal{M}_{p-1}}c(\\Delta_\\beta,\\Delta_\\alpha)\\Delta_\\alpha\\] \\[ c(\\Delta_\\beta,\\Delta_\\alpha)= \\begin{cases} 1, \\text{ if Card}(\\Gamma(\\Delta_\\beta,\\Delta\\alpha)) \\text{ is odd}\\\\ 0, \\text{ otherwise} \\end{cases} \\] Definition The Morse chain complex \\(\\mathcal{M}_\\ast\\) determines the homology of \\(\\mathcal{K}\\) \\[\\mathcal{M}_{\\ast}: \\dots \\overset{\\partial_{n+1}}{\\longrightarrow}\\mathcal{M}_{n}(K)\\overset{\\partial_{n}}{\\longrightarrow}\\mathcal{M}_{n-1}(K)\\overset{\\partial_{n-1}}{\\longrightarrow}\\dots\\overset{\\partial_{3}}{\\longrightarrow}\\mathcal{M}_{2}(K)\\overset{\\partial_{2}}{\\longrightarrow}\\mathcal{M}_{1}(K)\\overset{\\partial_{1}}{\\longrightarrow}\\mathcal{M}_{0}(K)\\] That is if we let \\(H(\\mathcal{M}_p,\\partial_p) = \\frac{\\text{Ker}(\\partial_p)}{\\text{Im} (\\partial_{p+1})}\\), then \\(H_p(\\mathcal{M}_p,\\partial_p)\\cong H_p(\\mathcal{K},\\mathbb{Z}_2)\\). Verifying that \\(\\partial_{n-1} \\circ \\partial_n: C_{n}(\\mathcal{K})\\to C_{n-2}(\\mathcal{K})\\), \\(\\partial_{n-1} \\circ \\partial_n(\\Delta_\\beta)\\mapsto 0\\). \\[ \\begin{aligned} \\partial_{n-1} \\circ \\partial_n(\\Delta_\\beta) &amp;= \\sum_{\\Delta_\\alpha\\in\\mathcal{M}_{p-1}}\\partial_{n} \\big(c(\\Delta_\\beta,\\Delta_\\alpha)\\Delta_\\alpha\\big)\\\\ &amp;= \\sum_{\\Delta_\\alpha\\in\\mathcal{M}_{p-1}}\\sum_{\\Delta_\\gamma\\in\\mathcal{M}_{p-2}} \\big(c(\\Delta_\\beta,\\Delta_\\alpha)c(\\Delta_\\alpha,\\Delta_\\gamma)\\Delta_\\gamma\\big)\\\\ &amp;= \\sum_{\\Delta_\\alpha\\in\\mathcal{M}_{p-1}}\\text{Card}\\Big[\\bigcup_{\\Delta_\\gamma\\in\\mathcal{M}_{p-2}} \\big(\\Gamma(\\Delta_\\beta,\\Delta_\\alpha)\\times\\Gamma(\\Delta_\\alpha,\\Delta_\\gamma)\\big)\\Big]\\Delta_\\gamma\\\\ &amp;= \\sum_{\\Delta_\\alpha\\in\\mathcal{M}_{p-1}}0\\Delta_\\gamma = 0 \\text{ (Since direction are inverted)}\\\\ \\end{aligned} \\] Theorem Discrete Poincaré–Hopf theorem Let there be an simplicial complex \\(\\mathcal{K}\\) and a discrete Morse function \\(f: \\mathcal{K} \\to \\mathbb{R}\\). Let \\(m_i\\) denotes the number of \\(i-\\)dimensional critical simplices \\(\\Delta^i\\in\\mathcal{K}\\) and \\(\\beta_i\\) denotes the number of \\(i-\\)dimensional cycles. Then: \\[\\chi(\\mathcal{K})=\\sum_{i=1}^{\\dim\\mathcal{K}}(-1)^i m_i = \\sum_{i=1}^{\\dim\\mathcal{K}}(-1)^i \\beta_i\\] Proof By definition, we have \\(H_p(\\mathcal{K}) = \\frac{\\text{Ker}(\\partial_p)}{\\text{Im} (\\partial_{p+1})}\\) so that \\(\\dim H_p(\\mathcal{K}) = \\dim \\text{Ker}(\\partial_p) - \\dim\\text{Im} (\\partial_{p+1})\\). \\[ \\begin{aligned} \\chi(\\mathcal{K}) &amp;= \\sum_{i=1}^{\\dim\\mathcal{K}}(-1)^i \\beta_i = \\sum_{i=0}^{\\dim\\mathcal{K}}(-1)^i \\dim H_p(\\mathcal{K})\\\\ &amp;= \\sum_{i=1}^{\\dim\\mathcal{K}}(-1)^i (\\dim \\text{Ker}(\\partial_p) - \\dim\\text{Im} (\\partial_{p+1})) \\\\ &amp;= \\sum_{i=0}^{\\dim\\mathcal{K}}(-1)^i \\dim \\text{Ker}(\\partial_p) + \\sum_{i=0}^{\\dim\\mathcal{K}}(-1)^{i+1} \\dim\\text{Im} (\\partial_{p+1})\\\\ &amp;= \\sum_{i=0}^{\\dim\\mathcal{K}}(-1)^i \\dim \\text{Ker}(\\partial_p) + \\sum_{i=0}^{\\dim\\mathcal{K}-1}(-1)^{i+1} \\dim\\text{Im} (\\partial_{p+1}) \\\\ &amp;\\text{ }\\text{ }\\text{ }\\text{ }\\text{ }\\text{ }\\text{ }\\text{ }\\text{ }\\text{ }\\text{ }\\text{ }\\text{ }\\text{ }\\text{ }\\text{ }\\text{ }\\text{ }+(-1)^{\\dim\\mathcal{K}}\\dim\\text{Im}(\\partial_{\\dim\\mathcal{K}}) + (-1)^0\\dim\\text{Im}(\\partial_0) \\\\ &amp;= \\sum_{i=0}^{\\dim\\mathcal{K}}(-1)^i \\dim \\text{Ker}(\\partial_p) + \\sum_{i=0}^{\\dim\\mathcal{K}}(-1)^{i} \\dim\\text{Im} (\\partial_{p}) \\\\ &amp;= \\sum_{i=0}^{\\dim\\mathcal{K}}(-1)^i (\\dim \\text{Ker}(\\partial_p) + \\dim\\text{Im} (\\partial_{p})) \\\\ &amp;= \\sum_{i=0}^{\\dim\\mathcal{K}}(-1)^i (C_i(\\mathcal{K})) = \\sum_{i=1}^{\\dim\\mathcal{K}}(-1)^i m_i \\end{aligned} \\] 2.3 Subset level filtration Definition Collapse (simplicial complex) A collapse of an arbitrary simplicial complex \\(\\mathcal{K}\\) to \\(\\mathcal{K}&#39;\\) (denoted as \\(\\mathcal{K}\\searrow\\mathcal{K}&#39;\\)) is the removal of all simplicies \\(\\Delta_\\gamma\\) such that \\(\\Delta_1\\subseteq\\Delta_\\gamma\\subseteq\\Delta_2\\) where \\(\\Delta_1\\) is a free-face. The main purpose is that \\(\\mathcal{K}\\) is homotopy equivalent to \\(\\mathcal{K}&#39;\\). Figure 2.6: Funky tikz Definition Level subcomplexes Let \\(c\\in\\mathbb{R}\\) be arbitrary, for a simplicial complex \\(\\mathcal{K}\\) with a discrete Morse function \\(f:\\mathcal{K}\\to\\mathbb{R}\\), the level sub-complexes is one induced by all simplicies \\(\\Delta\\in\\mathcal{K}\\) satisfying \\(f(\\Delta)\\leq c\\) with all of their faces: \\[\\mathcal{K}(c) = \\bigcup_{f(\\Delta)\\leq c}\\bigcup_{\\Delta&#39;\\in\\partial\\Delta} \\Delta\\] Theorem The collapse theorem Let there be a simplicial complex \\(\\mathcal{K}\\) with a gradient field \\(\\mathcal{V}\\) induced by an arbitrary discrete Morse function \\(f:\\mathcal{K}\\to\\mathbb{R}\\). For an arbitrary interval \\([a,b]\\) \\((\\forall a,b\\in\\mathbb{R})\\), if there exists no critical simplex \\(\\Delta\\in\\mathcal{K}\\) induced by \\(f\\) such that \\(f(\\Delta_{\\text{Critical}})\\in [a,b]\\) then \\(\\mathcal{K}(b)\\searrow\\mathcal{K}(a)\\). Otherwise, assume there exists an arbitrary \\(k-\\)simplex \\(\\Delta^k\\) (\\(k\\in\\mathbb{N}\\)) such that \\(f(\\Delta^k) \\in [a,b]\\). Proof Let there be a simplicial complex \\(\\mathcal{K}\\) with a gradient field \\(\\mathcal{V}\\) induced by an arbitrary discrete Morse function \\(f:\\mathcal{K}\\to\\mathbb{R}\\). Supposed that there exists no critical simplex \\(\\Delta\\in\\mathcal{K}\\) induced by \\(f\\) such that \\(f(\\Delta_{\\text{Critical}})\\in [a,b]\\) for arbitrary interval \\([a,b]\\subset\\mathbb{R}\\). If for all arbitrary simplex \\(\\Delta \\in\\mathcal{K}\\), then \\(f(\\Delta)\\notin[a,b]\\) so \\(\\mathcal{K}(b)\\searrow\\mathcal{K}(a)\\). Otherwise, let \\(\\epsilon &gt;0\\) be arbitrary such that there exists a unique \\(\\Delta\\in\\mathcal{K}\\) satisfying \\(f(\\Delta)\\in [b-\\epsilon,b] \\subset [a,b]\\) . By definition of \\(\\mathcal{V}\\), either: There exists \\(\\Delta^{k} \\in \\mathcal{K}(b)\\) such that \\(\\Delta\\in \\partial\\Delta^{k}\\) and \\(f(\\Delta) \\leq f(\\Delta^{k})\\) Or there exists \\(\\Delta^{k} \\in \\mathcal{K}(b)\\) such that \\(\\Delta^{k} \\in \\partial\\Delta\\) and \\(f(\\Delta^{k}) \\leq f(\\Delta)\\) Without loss of generality, assume there is \\(\\Delta^{k} \\in \\mathcal{K}(b)\\) such that \\(\\Delta \\in \\partial\\Delta^{k}\\) and \\(f(\\Delta) \\leq f(\\Delta^{k})\\), then it must be the case that \\(\\Delta\\) is a free-face of \\(\\Delta^{k}\\) in \\(\\mathcal{K}(b)\\). By way of contradiction, assume \\(\\Delta\\) is not a free-face of \\(\\Delta^{k}(b)\\), then there exists another \\(k-\\)simplex \\(\\tau^k \\in \\mathcal{K}(b)\\) (\\(\\tau^k \\neq \\Delta^k\\)) such that \\(\\Delta\\in\\partial\\tau^k\\). By definition of \\(f\\), it must be that \\(f(\\tau^{k})&gt; f(\\Delta^{k})\\) since \\(\\tau^{k}\\) and \\(\\Delta^{k}\\) are of the dimension and to make sure only 1 co-face of \\(\\Delta\\) has the same Morse value. Since \\(\\tau^k \\in \\mathcal{K}(b)\\): \\[b-\\epsilon &lt; f(\\Delta) \\leq f(\\Delta^K) &lt; f(\\tau^k) &lt; b\\] Since we assume there were no critical simplex in \\([b-\\epsilon,b]\\subset[a,b]\\), then \\(\\tau^k\\) is another regular simplex in \\([b-\\epsilon,b]\\), which is a contradiction since we assume \\(\\Delta^k\\) is the only regular simplex in \\([b-\\epsilon,b]\\). By repeating the same proccess for \\([b-\\epsilon&#39;,b-\\epsilon]\\subset[a,b-\\epsilon]\\) and so on. Thus, it must be that \\(\\Delta\\) is a free-face of \\(\\Delta^k\\) in \\(\\mathcal{K}(b)\\). The case is the same for if there exists \\(\\Delta^{k} \\in \\mathcal{K}(b)\\) such that \\(\\Delta^{k} \\in \\partial\\Delta\\) and \\(f(\\Delta^{k}) \\leq f(\\Delta)\\), therefore it must be true that \\(\\mathcal{K}(b)\\searrow\\mathcal{K}(a)\\). Theorem Lower-star filtration Let \\(\\mathcal{K}\\) be a simplicial complex consisting of \\(m\\) simplices and a function \\(f:V(\\mathcal{K})\\to \\mathbb{R}, v_i\\mapsto\\mathbb{R}\\) that assigning a real value for all vectors contained in any arbitrary simplex in \\(\\mathcal{K}\\). Rewritten arbitrary \\(k-\\)simplex of \\(\\mathcal{K}\\) as collection of vectors \\([v_0,v_1,\\dots,v_{k+1}]\\), define the Morse function \\(f&#39;:\\mathcal{K}\\to\\mathbb{R}\\) as \\[f&#39;([v_0,v_1,\\dots,v_{k}])=\\max\\{\\{f(v_i)\\vert i=0,\\dots,k\\}\\}\\] Reordered to simplicies in \\(\\mathcal{K}\\) into an ordered sequences \\(S = \\Delta_1,\\Delta_2,\\dots\\Delta_m\\) where faces of \\(\\Delta_k\\) appears before \\(\\Delta_k\\) for \\(i=1,2,\\dots,m\\). For decreasing \\(\\epsilon_i &gt; 0\\) (\\(i = 0,1,2,\\dots\\))consider the sublevel sets chain complex: \\[\\mathcal{K}_{\\ast}: \\dots \\overset{\\partial_{n+1}}{\\longrightarrow}\\mathcal{K}(\\epsilon_n)\\overset{\\partial_{n}}{\\longrightarrow}\\mathcal{K}(\\epsilon_{n-1})\\overset{\\partial_{n-1}}{\\longrightarrow}\\dots\\overset{\\partial_{4}}{\\longrightarrow}\\mathcal{K}(\\epsilon_{3})\\overset{\\partial_{3}}{\\longrightarrow}\\mathcal{K}(\\epsilon_{2})\\overset{\\partial_{2}}{\\longrightarrow}\\mathcal{K}(\\epsilon_{1})\\overset{\\partial_{1}}{\\longrightarrow}\\mathcal{K}(\\epsilon_{0}) = \\mathcal{K}\\] Passing to homology, we have the persistence module \\(H_\\ast = \\bigoplus_{z\\in\\mathbb{Z}_2}H(\\mathcal{K}(\\epsilon_i))\\). A persistent pairing induced by \\(\\mathcal{K}_\\ast\\) is the pair of simplicial complex \\((\\Delta_i,\\Delta_j)\\) for \\(\\Delta_i \\in \\mathcal{K}(\\epsilon_i),\\Delta_j \\in \\mathcal{K}(\\epsilon_j)\\) are the critical simplices of their respective homology class. Let \\(\\text{pers}(\\Delta_i,\\Delta_j) = f&#39;(\\Delta_j)-f&#39;(\\Delta_i)\\) denotes the persistence of all arbitrary persistence-pairing, which indicates the life-time where a critical simplex is created at the time \\(i\\) and destroyed at time \\(j\\). Since not all simplicies can be paired, let creates the a simplex \\(\\Delta_\\infty\\) such that \\(f&#39;(\\Delta_\\infty)\\) be arbitrary large (hence, \\(\\text{pers}(\\Delta,\\Delta_\\infty)=\\infty\\)). "],["image-segmentation.html", "Chapter 3 Image segmentation 3.1 The architecture 3.2 Result", " Chapter 3 Image segmentation 3.1 The architecture 3.2 Result "],["brain-network-analysis.html", "Chapter 4 Brain Network Analysis 4.1 The architecture 4.2 Result", " Chapter 4 Brain Network Analysis 4.1 The architecture 4.2 Result "],["conclusion.html", "Chapter 5 Conclusion 5.1 Limitations 5.2 Future work", " Chapter 5 Conclusion 5.1 Limitations 5.2 Future work "],["references.html", "References", " References "]]
